@{
    ViewData["Title"] = "B√°o C√°o Doanh S·ªë";
    var sanPhamBanChay = ViewBag.SanPhamBanChay as List<dynamic>;
}
<partial name="_NavbarPartial" />
<div class="container mt-4">
    <h2 class="text-center">üìä B√°o C√°o Doanh S·ªë</h2>

    <div class="mb-3 pt-5" style=" width: 300px;  ">
        <label for="datePicker" class="form-label">Ch·ªçn ng√†y:</label>
        <input type="date" id="datePicker" class="form-control" style="border: 1px solid blue" />
    </div>

    <div class="row">
        <div class="col-md-4">
            <div class="card text-white bg-primary mb-3">
                <div class="card-header">üí∞ Doanh S·ªë H√¥m Nay</div>
                <div class="card-body">
                    <h3 id="doanhSoNgay">@ViewBag.DoanhSoHomNay VND</h3>
                </div>
            </div>
        </div>

        <div class="col-md-4">
            <div class="card text-white bg-success mb-3">
                <div class="card-header">üìÜ Doanh S·ªë Th√°ng N√†y</div>
                <div class="card-body">
                    <h3 id="doanhSoThang">@ViewBag.DoanhSoThangNay VND</h3>
                </div>
            </div>
        </div>

        <div class="col-md-4">
            <div class="card text-white bg-warning mb-3">
                <div class="card-header">üìÖ Doanh S·ªë NƒÉm Nay</div>
                <div class="card-body">
                    <h3 id="doanhSoNam">@ViewBag.DoanhSoNamNay VND</h3>
                </div>
            </div>
        </div>
    </div>
    <!-- S·∫£n ph·∫©m b√°n ch·∫°y -->
    <h3 class="mt-4">üî• S·∫£n Ph·∫©m B√°n Ch·∫°y</h3>
    <table class="table table-striped">
        <thead>
            <tr>
                <th>STT</th>
                <th>T√™n S·∫£n Ph·∫©m</th>
                <th>S·ªë L∆∞·ª£ng B√°n</th>
            </tr>
        </thead>
        <tbody>
            @if (sanPhamBanChay != null && sanPhamBanChay.Count > 0)
            {
                int i = 1;
                foreach (var sp in sanPhamBanChay)
                {
                    <tr>
                        <td>@i</td>
                        <td>@sp.MaSP</td>
                        <td>@sp.TenSP</td>
                        <td>@sp.SoLuongBan</td>
                    </tr>
                    i++;
                }
            }
            else
            {
                <tr>
                    <td colspan="3" class="text-center text-muted">Kh√¥ng c√≥ d·ªØ li·ªáu</td>
                </tr>
            }
        </tbody>
    </table>
</div>
</div>

<script>
     // Thi·∫øt l·∫≠p gi√° tr·ªã m·∫∑c ƒë·ªãnh c·ªßa √¥ nh·∫≠p li·ªáu ng√†y l√† h√¥m nay
        document.addEventListener("DOMContentLoaded", function() {
        var today = new Date();
        var day = String(today.getDate()).padStart(2, '0');
        var month = String(today.getMonth() + 1).padStart(2, '0'); // Th√°ng b·∫Øt ƒë·∫ßu t·ª´ 0
        var year = today.getFullYear();
        var todayString = year + '-' + month + '-' + day;
        var datePicker = document.getElementById('datePicker');
        datePicker.value = todayString;
        // K√≠ch ho·∫°t s·ª± ki·ªán change ƒë·ªÉ l·∫•y d·ªØ li·ªáu doanh s·ªë cho h√¥m nay
        datePicker.dispatchEvent(new Event('change'));
    });

    // thi·∫øt l·∫≠p s·ª± ki·ªán thay ƒë·ªïi ng√†y
    document.getElementById("datePicker").addEventListener("change", function () {
        var selectedDate = this.value;
        fetch(`/BaoCao/GetDoanhSoTheoNgay?date=${selectedDate}`)
            .then(response => response.json())
            .then(data => {
                document.getElementById("doanhSoNgay").innerText = data.ngay + " VND";
                document.getElementById("doanhSoThang").innerText = data.thang + " VND";
                document.getElementById("doanhSoNam").innerText = data.nam + " VND";
            });
    });
</script>

